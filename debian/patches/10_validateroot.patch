#! /bin/sh /usr/share/dpatch/dpatch-run
## 10_validateroot.dpatch by Christian Hofstaedtler <ch@grml.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: add live-bottom/10validateroot

@DPATCH@
Index: b/scripts/live-bottom/10validateroot
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ b/scripts/live-bottom/10validateroot	2011-07-24 22:08:00.000000000 +0200
@@ -0,0 +1,27 @@
+#!/bin/sh
+
+#set -e
+
+# initramfs-tools header
+
+PREREQ=""
+
+prereqs()
+{
+        echo "${PREREQ}"
+}
+
+case "${1}" in
+        prereqs)
+                prereqs
+                exit 0
+                ;;
+esac
+
+. /scripts/live-functions
+. /scripts/live-helpers
+
+if ! [ -x "/root/sbin/init" ] ; then
+  panic "rootfs can not be mounted as supposed because of fatal error during bootup."
+fi
+
